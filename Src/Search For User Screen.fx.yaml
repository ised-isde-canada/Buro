"'Search For User Screen' As screen":
    OnVisible: |-
        =//Call Loading animation and set default var values
        UpdateContext(
            {
                locIsLoadingVisible: false,
                locStartLoadingTimer: false,
                locIsDoneLoadingVisible: false,
                locStartDoneTimer: false,
                locLoadingDuration: gblBaseLoadTime,
                locCurrSearchText: ""
            }
        );
        Clear(colFindAColleague_Results);
        
        Reset(txtSearchForUserSFUS);
        Reset(galFoundUsersSFUS);

    shpScreenBackdropSFUS As rectangle:
        BorderColor: =RGBA(255, 255, 255, 1)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        Fill: =RGBA(224, 224, 224,1)
        Height: =Parent.Height
        Width: =Parent.Width
        ZIndex: =1

    shpPageBackdropSFUS As rectangle:
        BorderColor: =RGBA(204, 204, 204, 1)
        BorderThickness: =2
        Fill: =LookUp(Colors, Color = "Background", RGB)
        FocusedBorderThickness: =4
        Height: =Parent.Height
        Width: =If(Parent.Size <> ScreenSize.ExtraLarge, App.Width, App.DesignWidth * 2)
        X: =(Parent.Width-Self.Width) /2
        ZIndex: =2

    btnBackToReviewSFUS As button:
        BorderColor: =Color.White
        BorderThickness: |-
            =Min(2 * Switch(Value(lblScreenWidthSizingSFUS.Text),
                        ScreenSize.Small, 1,
                        ScreenSize.Medium, 1.25,
                        ScreenSize.Large, 1.5,
                        1.75),
                2 * Switch(cmpScreenFunctionsSFUS.ScreenSize,
                        ScreenSize.Small, 1,
                        ScreenSize.Medium, 1.25,
                        ScreenSize.Large, 1.5,
                        1.75)
            )
        DisabledColor: =LookUp(Colors, Color = "Background", RGB)
        DisabledFill: =LookUp(Colors, Color = "Grey", RGB)
        Fill: =LookUp(Colors, Color = "Primary", RGB)
        FocusedBorderColor: =LookUp(Colors, Color = "Focus Primary", RGB)
        FocusedBorderThickness: |-
            =Min(2.5 * Switch(Value(lblScreenWidthSizingSFUS.Text),
                        ScreenSize.Small, 1,
                        ScreenSize.Medium, 1.25,
                        ScreenSize.Large, 1.5,
                        1.75),
                2.5 * Switch(cmpScreenFunctionsSFUS.ScreenSize,
                        ScreenSize.Small, 1,
                        ScreenSize.Medium, 1.25,
                        ScreenSize.Large, 1.5,
                        1.75)
            )
        Font: =Font.'Lato Black'
        Height: |-
            =Min(100 * Switch(Value(lblScreenWidthSizingSFUS.Text),  
                    ScreenSize.Small, 0.75,  
                    ScreenSize.Medium, 0.9,  
                    ScreenSize.Large, 1.125,
                    1.25),
                100 * Switch(cmpScreenFunctionsSFUS.ScreenSize,  
                    ScreenSize.Small, 0.75,  
                    ScreenSize.Medium, 0.9,  
                    ScreenSize.Large, 1.125,
                    1.25) 
            )
        HoverBorderColor: =RGBA(0,0,0,0)
        HoverColor: =btnBackToReviewSFUS.Color
        HoverFill: =LookUp(Colors, Color = "Muted Primary", RGB)
        OnSelect: =Navigate('Review Booking Screen')
        PressedBorderColor: =RGBA(0,0,0,0)
        PressedFill: =Color.White
        RadiusBottomLeft: =Self.RadiusTopLeft
        RadiusBottomRight: =Self.RadiusTopLeft
        RadiusTopLeft: |-
            =Min(15 * Switch(Value(lblScreenWidthSizingSFUS.Text),  
                    ScreenSize.Small, 1,  
                    ScreenSize.Medium, 1.25,
                    ScreenSize.Large, 1.5,  
                    2),
                15 * Switch(cmpScreenFunctionsSFUS.ScreenSize,  
                    ScreenSize.Small, 1,  
                    ScreenSize.Medium, 1.25,
                    ScreenSize.Large, 1.5,  
                    2)
            )
        RadiusTopRight: =Self.RadiusTopLeft
        Size: |-
            =Min(18 * Switch(Value(lblScreenWidthSizingSFUS.Text),  
                    ScreenSize.Small, 1,  
                    ScreenSize.Medium, 1.25,
                    ScreenSize.Large, 1.75,  
                    1.9),
                18 * Switch(cmpScreenFunctionsSFUS.ScreenSize,  
                    ScreenSize.Small, 1,  
                    ScreenSize.Medium, 1.25,
                    ScreenSize.Large, 1.75,  
                    1.9) 
            )
        TabIndex: =If(imgRefineSearchSFUS.Visible, 0, -1)
        Text: =LookUp(colTranslationTable, key = "searchforuser.backtoreview" && language.Value = gblAppUserLang, text)
        Tooltip: =
        Visible: =CountRows(galFoundUsersSFUS.AllItems) < 1 && IsBlank(First(galFoundUsersSFUS.AllItems).Id)
        Width: =crdGalleryBackgroundSFUS.Width
        X: =shpPageBackdropSFUS.X + shpPageBackdropSFUS.Width/2 - Self.Width/2
        Y: |-
            =crdGalleryBackgroundSFUS.Y + crdGalleryBackgroundSFUS.Height + 
            Min(25 * Switch(Value(lblScreenWidthSizingSFUS.Text),  
                    ScreenSize.Small, 1,  
                    ScreenSize.Medium, 1.5, 
                    ScreenSize.Large, 1.75,
                    2),
                 25 * Switch(cmpScreenFunctionsSFUS.ScreenSize,  
                    ScreenSize.Small, 1,  
                    ScreenSize.Medium, 1.5, 
                    ScreenSize.Large, 1.75,
                    2)
            )   
        ZIndex: =5

    crdGalleryBackgroundSFUS As button:
        BorderColor: =LookUp(Colors, Color = "Primary", RGB)
        BorderThickness: =0
        Color: =RGBA(0,0,0,0)
        DisabledBorderColor: =Self.BorderColor
        DisabledColor: =Self.Color
        DisabledFill: =Self.Fill
        DisplayMode: =DisplayMode.Disabled
        Fill: =Color.White
        FocusedBorderThickness: =0
        Height: |-
            =If(CountRows(galFoundUsersSFUS.AllItems) < 1,
            400 * Switch(cmpScreenFunctionsSFUS.ScreenSize,  
                    ScreenSize.Small, 0.5,  
                    ScreenSize.Medium, 1,
                    ScreenSize.Large, 1.5, 
                    1.85),
            /*
            400 * Switch(cmpScreenFunctionsSFUS.ScreenSize,  
                    ScreenSize.Small, 0.75,  
                    ScreenSize.Medium, 1.25,
                    ScreenSize.Large, 1.75, 
                    2)
                    */
            shpPageBackdropTS.Height - Self.Y - 
            Min(40 * Switch(Value(lblScreenWidthSizingSFUS.Text),  
                    ScreenSize.Small, 1,  
                    ScreenSize.Medium, 1.5,
                    ScreenSize.Large, 1.75,  
                    2),
                40 * Switch(cmpScreenFunctionsSFUS.ScreenSize,  
                    ScreenSize.Small, 1,  
                    ScreenSize.Medium, 1.5,
                    ScreenSize.Large, 1.75,  
                    2) 
            )
            )
        HoverColor: =RGBA(0, 0, 0, 0)
        HoverFill: =
        PressedColor: =
        PressedFill: =
        RadiusBottomLeft: =Self.RadiusTopLeft
        RadiusBottomRight: =Self.RadiusTopLeft
        RadiusTopLeft: |-
            =Min(15 * Switch(Value(lblScreenWidthSizingSFUS.Text),  
                    ScreenSize.Small, 1,  
                    ScreenSize.Medium, 1.25,
                    ScreenSize.Large, 1.5,  
                    2),
                15 * Switch(cmpScreenFunctionsSFUS.ScreenSize,  
                    ScreenSize.Small, 1,  
                    ScreenSize.Medium, 1.25,
                    ScreenSize.Large, 1.5,  
                    2)
            )
        RadiusTopRight: =Self.RadiusTopLeft
        Size: =0
        TabIndex: =-1
        Text: =""
        Width: |-
            =cmpHeaderSFUS.Width
            - (10 * Switch(Value(lblScreenWidthSizingSFUS.Text),  
                    ScreenSize.Small, 1,  
                    ScreenSize.Medium, 1.5,  
                    ScreenSize.Large, 1.75,
                    5))
            - (25 * Switch(Value(lblScreenWidthSizingSFUS.Text),  
                    ScreenSize.Small, 1,  
                    ScreenSize.Medium, 1.5,  
                    ScreenSize.Large, 1.75,
                    5))
        X: =shpPageBackdropSFUS.X + shpPageBackdropSFUS.Width/2 - Self.Width/2
        Y: |-
            =txtSearchForUserSFUS.Y + txtSearchForUserSFUS.Height + 
            Min(40 * Switch(Value(lblScreenWidthSizingSFUS.Text),  
                    ScreenSize.Small, 1,  
                    ScreenSize.Medium, 1.5,
                    ScreenSize.Large, 1.75,  
                    2),
                40 * Switch(cmpScreenFunctionsSFUS.ScreenSize,  
                    ScreenSize.Small, 1,  
                    ScreenSize.Medium, 1.5,
                    ScreenSize.Large, 1.75,  
                    2) 
            )
        ZIndex: =6

    "galFoundUsersSFUS As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver4.0'":
        AccessibleLabel: =LookUp(colTranslationTable, key = "reviewbooking.userlookup.gallery.aria" && language.Value = gblAppUserLang, text)
        FocusedBorderColor: =
        FocusedBorderThickness: =0
        Height: |-
            =(crdGalleryBackgroundSFUS.Height) - 15 * Switch(Value(lblScreenWidthSizingSFUS.Text),  
                    ScreenSize.Small, 1,  
                    ScreenSize.Medium, 1.5, 
                    ScreenSize.Large, 1.75,
                    2) * 2
        Items: =colFindAColleague_Results
        Layout: =Layout.Vertical
        LoadingSpinnerColor: =
        OnSelect: |-
            =Navigate('Review Booking Screen', ScreenTransition.CoverRight, {locSelectedUser: ThisItem});
        TemplatePadding: =0
        TemplateSize: |-
            =Min(140 * Switch(Value(lblScreenWidthSizingSFUS.Text),  
                    ScreenSize.Small, 1,  
                    ScreenSize.Medium, 1.25,
                    ScreenSize.Large, 1.5,  
                    2),
                140 * Switch(cmpScreenFunctionsSFUS.ScreenSize,  
                    ScreenSize.Small, 1,  
                    ScreenSize.Medium, 1.25,
                    ScreenSize.Large, 1.5,  
                    2)
            ) 
        Visible: =CountRows(Self.AllItems) >= 1 && !IsBlank(First(Self.AllItems).Id)
        Width: |-
            =cmpHeaderSFUS.Width
            - (10 * Switch(Value(lblScreenWidthSizingSFUS.Text),  
                    ScreenSize.Small, 1,  
                    ScreenSize.Medium, 1.5,  
                    ScreenSize.Large, 1.75,
                    5))
            - (25 * Switch(Value(lblScreenWidthSizingSFUS.Text),  
                    ScreenSize.Small, 1,  
                    ScreenSize.Medium, 1.5,  
                    ScreenSize.Large, 1.75,
                    5))
        X: =shpPageBackdropSFUS.X + shpPageBackdropSFUS.Width/2 - Self.Width/2
        Y: |-
            =crdGalleryBackgroundSFUS.Y + 15 *  Switch(Value(lblScreenWidthSizingSFUS.Text),  
                    ScreenSize.Small, 1,  
                    ScreenSize.Medium, 1.5,
                    ScreenSize.Large, 1.75,
                    2)
        ZIndex: =9

        imgUserIconSFUS As image:
            Fill: =//Rand()RGBA(253, 222, 207, 1)
            Height: =Self.Width
            Image: ='my_profile (deselected - purple)'
            OnSelect: =Select(Parent)
            PaddingBottom: =10
            PaddingLeft: =10
            PaddingRight: =10
            PaddingTop: =10
            RadiusBottomLeft: =Self.RadiusTopLeft
            RadiusBottomRight: =Self.RadiusTopLeft
            RadiusTopLeft: |-
                =75 * Switch(
                    Value(lblScreenWidthSizingSFUS.Text),
                    ScreenSize.Small,
                    1,
                    ScreenSize.Medium,
                    1.5,
                    ScreenSize.Large,
                    1.75,
                    2
                )
            RadiusTopRight: =Self.RadiusTopLeft
            Width: =Parent.TemplateHeight/2.5
            X: |-
                =25 * Switch(Value(lblScreenWidthSizingSFUS.Text),  
                        ScreenSize.Small, 1,  
                        ScreenSize.Medium, 1.5,
                        ScreenSize.Large, 1.75,
                        2)
            Y: =(Parent.TemplateHeight / 2) - (Self.Height / 2)
            ZIndex: =1

        lblUserDetailsEmailSFUS As label:
            Color: =LookUp(Colors, Color = "Grey", RGB)
            Font: =Font.Lato
            Height: =Self.Size * 1.8
            OnSelect: =Select(Parent)
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: |-
                =Min(12 * Switch(Value(lblScreenWidthSizingSFUS.Text),  
                        ScreenSize.Small, 1,  
                        ScreenSize.Medium, 1.25,
                        ScreenSize.Large, 1.5,  
                        2),
                    12 * Switch(cmpScreenFunctionsSFUS.ScreenSize,  
                        ScreenSize.Small, 1,  
                        ScreenSize.Medium, 1.25,
                        ScreenSize.Large, 1.5,  
                        2)
                )
            Text: ="(" & If(IsBlank(ThisItem.Mail), "Unknown", Lower(ThisItem.Mail)) & ")"
            Tooltip: =
            Width: |-
                =Parent.Width - Self.X - 
                Min(25 * Switch(Value(lblScreenWidthSizingSFUS.Text),  
                        ScreenSize.Small, 1,  
                        ScreenSize.Medium, 1.25,
                        ScreenSize.Large, 1.5,  
                        2),
                    25 * Switch(cmpScreenFunctionsSFUS.ScreenSize,  
                        ScreenSize.Small, 1,  
                        ScreenSize.Medium, 1.25,
                        ScreenSize.Large, 1.5,  
                        2)
                )
            Wrap: =false
            X: |-
                =imgUserIconSFUS.X + imgUserIconSFUS.Width + 
                Min(25 * Switch(Value(lblScreenWidthSizingSFUS.Text),  
                        ScreenSize.Small, 1,  
                        ScreenSize.Medium, 1.25,
                        ScreenSize.Large, 1.5,  
                        2),
                    25 * Switch(cmpScreenFunctionsSFUS.ScreenSize,  
                        ScreenSize.Small, 1,  
                        ScreenSize.Medium, 1.25,
                        ScreenSize.Large, 1.5,  
                        2)
                )
            Y: =lblUserDetailsJobTitleSFUS.Y + lblUserDetailsJobTitleSFUS.Height + 5
            ZIndex: =2

        lblUserDetailsJobTitleSFUS As label:
            Color: =LookUp(Colors, Color = "Grey", RGB)
            Font: =Font.Lato
            Height: =Self.Size * 1.8
            OnSelect: =Select(Parent)
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: |-
                =Min(14 * Switch(Value(lblScreenWidthSizingSFUS.Text),  
                        ScreenSize.Small, 1,  
                        ScreenSize.Medium, 1.25,
                        ScreenSize.Large, 1.5,  
                        2),
                    14 * Switch(cmpScreenFunctionsSFUS.ScreenSize,  
                        ScreenSize.Small, 1,  
                        ScreenSize.Medium, 1.25,
                        ScreenSize.Large, 1.5,  
                        2)
                )
            Text: =If(IsBlank(ThisItem.JobTitle), LookUp(colTranslationTable, key = "searchforuser.missingemail" && language.Value = gblAppUserLang, text), ThisItem.JobTitle)
            Tooltip: =
            Width: |-
                =Parent.Width - Self.X - 
                Min(25 * Switch(Value(lblScreenWidthSizingSFUS.Text),  
                        ScreenSize.Small, 1,  
                        ScreenSize.Medium, 1.25,
                        ScreenSize.Large, 1.5,  
                        2),
                    25 * Switch(cmpScreenFunctionsSFUS.ScreenSize,  
                        ScreenSize.Small, 1,  
                        ScreenSize.Medium, 1.25,
                        ScreenSize.Large, 1.5,  
                        2)
                )
            Wrap: =false
            X: |-
                =imgUserIconSFUS.X + imgUserIconSFUS.Width + 
                Min(25 * Switch(Value(lblScreenWidthSizingSFUS.Text),  
                        ScreenSize.Small, 1,  
                        ScreenSize.Medium, 1.25,
                        ScreenSize.Large, 1.5,  
                        2),
                    25 * Switch(cmpScreenFunctionsSFUS.ScreenSize,  
                        ScreenSize.Small, 1,  
                        ScreenSize.Medium, 1.25,
                        ScreenSize.Large, 1.5,  
                        2)
                )
            Y: |-
                =//htmlUserDetailsNameSFUS.Y + htmlUserDetailsNameSFUS.Height + 5
                Parent.TemplateHeight/2 - Self.Height/2
            ZIndex: =3

        lblUserNameSFUS As label:
            Color: =LookUp(Colors, Color = "Primary", RGB)
            Font: =Font.'Lato Black'
            Height: =Self.Size * 1.8
            OnSelect: =Select(Parent)
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Role: =TextRole.Heading4
            Size: |-
                =Min(16 * Switch(Value(lblScreenWidthSizingSFUS.Text),  
                        ScreenSize.Small, 1,  
                        ScreenSize.Medium, 1.25,
                        ScreenSize.Large, 1.5,  
                        2),
                    16 * Switch(cmpScreenFunctionsSFUS.ScreenSize,  
                        ScreenSize.Small, 1,  
                        ScreenSize.Medium, 1.25,
                        ScreenSize.Large, 1.5,  
                        2)
                )
            Text: =ThisItem.GivenName & " " & ThisItem.Surname
            Width: |-
                =Parent.Width - Self.X - 
                Min(25 * Switch(Value(lblScreenWidthSizingSFUS.Text),  
                        ScreenSize.Small, 1,  
                        ScreenSize.Medium, 1.25,
                        ScreenSize.Large, 1.5,  
                        2),
                    25 * Switch(cmpScreenFunctionsSFUS.ScreenSize,  
                        ScreenSize.Small, 1,  
                        ScreenSize.Medium, 1.25,
                        ScreenSize.Large, 1.5,  
                        2)
                )
            Wrap: =false
            X: |-
                =imgUserIconSFUS.X + imgUserIconSFUS.Width + 
                Min(25 * Switch(Value(lblScreenWidthSizingSFUS.Text),  
                        ScreenSize.Small, 1,  
                        ScreenSize.Medium, 1.25,
                        ScreenSize.Large, 1.5,  
                        2),
                    25 * Switch(cmpScreenFunctionsSFUS.ScreenSize,  
                        ScreenSize.Small, 1,  
                        ScreenSize.Medium, 1.25,
                        ScreenSize.Large, 1.5,  
                        2)
                )
            Y: |-
                =//Parent.TemplateHeight/5
                lblUserDetailsJobTitleSFUS.Y - Self.Height - 5
            ZIndex: =4

        btnAccessibilityGalUsersSFUS As button:
            BorderColor: =RGBA(0,0,0,0)
            BorderThickness: =
            Fill: =RGBA(0,0,0,0)
            FocusedBorderColor: =LookUp(Colors, Color = "Focus Primary", RGB)
            FocusedBorderThickness: |-
                =Min(2.5 * Switch(Value(lblScreenWidthSizingSFUS.Text),
                            ScreenSize.Small, 1,
                            ScreenSize.Medium, 1.25,
                            ScreenSize.Large, 1.5,
                            1.75),
                    2.5 * Switch(cmpScreenFunctionsSFUS.ScreenSize,
                            ScreenSize.Small, 1,
                            ScreenSize.Medium, 1.25,
                            ScreenSize.Large, 1.5,
                            1.75)
                )
            Height: =Parent.TemplateHeight - Self.FocusedBorderThickness
            HoverBorderColor: =
            HoverColor: =Self.Color
            HoverFill: =RGBA(0,0,0,0.05)
            OnSelect: =Select(Parent)
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            PressedColor: =Self.Color
            PressedFill: =RGBA(0,0,0,0.1)
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =0
            Text: |-
                =LookUp(colTranslationTable, key = "searchforuser.selectcolleague" && language.Value = gblAppUserLang, text) & ": " & ThisItem.GivenName & " " & ThisItem.Surname & ", " & ThisItem.Mail
            Width: =Parent.TemplateWidth - Self.FocusedBorderThickness
            X: =Self.FocusedBorderThickness/2
            Y: =Self.FocusedBorderThickness/2
            ZIndex: =5

    lblFoundColleaguesGallerySFUS As label:
        Height: =0
        Role: =TextRole.Heading2
        Size: =0
        Text: =LookUp(colTranslationTable, key = "searchforuser.list" && language.Value = gblAppUserLang, text)
        Width: =0
        X: =galFoundUsersSFUS.X
        Y: =galFoundUsersSFUS.Y - 1
        ZIndex: =10

    txtSearchForUserSFUS As text:
        AccessibleLabel: =//Self.HintText
        BorderColor: =LookUp(Colors, Color = "Grey", RGB)
        BorderThickness: =0
        Color: =LookUp(Colors, Color = "Primary", RGB)
        Default: =""
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =Self.Color
        DisabledFill: =Self.Fill
        Fill: =Color.White
        FocusedBorderColor: =LookUp(Colors, Color = "Focus Primary", RGB)
        FocusedBorderThickness: |-
            =Min(2.5 * Switch(Value(lblScreenWidthSizingSFUS.Text),
                        ScreenSize.Small, 1,
                        ScreenSize.Medium, 1.25,
                        ScreenSize.Large, 1.5,
                        1.75),
                2.5 * Switch(cmpScreenFunctionsSFUS.ScreenSize,
                        ScreenSize.Small, 1,
                        ScreenSize.Medium, 1.25,
                        ScreenSize.Large, 1.5,
                        1.75)
            )
        Font: =Font.Lato
        Height: |-
            =Min(50 * Switch(Value(lblScreenWidthSizingSFUS.Text),  
                    ScreenSize.Small, 1,  
                    ScreenSize.Medium, 1.5,
                    ScreenSize.Large, 1.75,  
                    2),
                50 * Switch(cmpScreenFunctionsSFUS.ScreenSize,  
                    ScreenSize.Small, 1,  
                    ScreenSize.Medium, 1.5,
                    ScreenSize.Large, 1.75,  
                    2) 
            )
        HintText: =LookUp(colTranslationTable, key = "reviewbooking.search.hint" && language.Value = gblAppUserLang, text)
        HoverBorderColor: =
        HoverColor: =Self.Color
        HoverFill: =RGBA(0, 0, 0, 0.05)
        PaddingLeft: |-
            =Min(25 * Switch(Value(lblScreenWidthSizingSFUS.Text),  
                    ScreenSize.Small, 1,  
                    ScreenSize.Medium, 1.5,
                    ScreenSize.Large, 1.75,  
                    2),
                25 * Switch(cmpScreenFunctionsSFUS.ScreenSize,  
                    ScreenSize.Small, 1,  
                    ScreenSize.Medium, 1.5,
                    ScreenSize.Large, 1.75,  
                    2)
            )
        PaddingRight: |-
            =Min(25 * Switch(Value(lblScreenWidthSizingSFUS.Text),  
                    ScreenSize.Small, 1,  
                    ScreenSize.Medium, 1.5,
                    ScreenSize.Large, 1.75,  
                    2),
                25 * Switch(cmpScreenFunctionsSFUS.ScreenSize,  
                    ScreenSize.Small, 1,  
                    ScreenSize.Medium, 1.5,
                    ScreenSize.Large, 1.75,  
                    2)
            )
        PressedBorderColor: =RGBA(0,0,0,0)
        PressedFill: =RGBA(0,0,0,0.1)
        RadiusBottomLeft: =Self.RadiusTopLeft
        RadiusBottomRight: =0
        RadiusTopLeft: |-
            =Min(25 * Switch(Value(lblScreenWidthSizingSFUS.Text),  
                    ScreenSize.Small, 1,  
                    ScreenSize.Medium, 1.5,
                    ScreenSize.Large, 1.75,  
                    2),
                25 * Switch(cmpScreenFunctionsSFUS.ScreenSize,  
                    ScreenSize.Small, 1,  
                    ScreenSize.Medium, 1.5,
                    ScreenSize.Large, 1.75,  
                    2)
            )
        RadiusTopRight: =0
        Size: |-
            =Min(14 * Switch(Value(lblScreenWidthSizingSFUS.Text),  
                    ScreenSize.Small, 1,  
                    ScreenSize.Medium, 1.5,
                    ScreenSize.Large, 1.75,  
                    2),
                14 * Switch(cmpScreenFunctionsSFUS.ScreenSize,  
                    ScreenSize.Small, 1,  
                    ScreenSize.Medium, 1.5,
                    ScreenSize.Large, 1.75,  
                    2) 
            )
        Width: |-
            =cmpHeaderSFUS.Width
            - (10 * Switch(Value(lblScreenWidthSizingSFUS.Text),  
                    ScreenSize.Small, 1,  
                    ScreenSize.Medium, 1.5,  
                    ScreenSize.Large, 1.75,
                    5))
            - (25 * Switch(Value(lblScreenWidthSizingSFUS.Text),  
                    ScreenSize.Small, 1,  
                    ScreenSize.Medium, 1.5,  
                    ScreenSize.Large, 1.75,
                    5))
            - imgSearchButtonSFUS.Width
        X: =crdGalleryBackgroundSFUS.X
        Y: |-
            =cmpHeaderSFUS.Y + cmpHeaderSFUS.Height + 
            Min(40 * Switch(Value(lblScreenWidthSizingSFUS.Text),  
                    ScreenSize.Small, 1,  
                    ScreenSize.Medium, 1.5,
                    ScreenSize.Large, 1.75,  
                    2),
                40 * Switch(cmpScreenFunctionsSFUS.ScreenSize,  
                    ScreenSize.Small, 1,  
                    ScreenSize.Medium, 1.5,
                    ScreenSize.Large, 1.75,  
                    2) 
            )
        ZIndex: =11

    imgSearchButtonSFUS As image:
        AccessibleLabel: =LookUp(colTranslationTable, key = "searchforuser.search" && language.Value = gblAppUserLang, text)
        AutoDisableOnSelect: =false
        BorderColor: =LookUp(Colors, Color = "Primary", RGB)
        DisabledFill: =LookUp(Colors, Color = "Grey", RGB)
        Fill: =LookUp(Colors, Color = "Primary", RGB)
        FocusedBorderColor: =LookUp(Colors, Color = "Focus Primary", RGB)
        FocusedBorderThickness: |-
            =Min(2.5 * Switch(Value(lblScreenWidthSizingSFUS.Text),
                        ScreenSize.Small, 1,
                        ScreenSize.Medium, 1.25,
                        ScreenSize.Large, 1.5,
                        1.75),
                2.5 * Switch(cmpScreenFunctionsSFUS.ScreenSize,
                        ScreenSize.Small, 1,
                        ScreenSize.Medium, 1.25,
                        ScreenSize.Large, 1.5,
                        1.75)
            )
        Height: =txtSearchForUserSFUS.Height
        HoverBorderColor: =RGBA(0,0,0,0)
        HoverFill: =LookUp(Colors, Color = "Muted Primary", RGB)
        Image: ='search (white)'
        OnSelect: |-
            =//Start the loading animation
            If(!IsBlank(txtSearchForUserSFUS.Text) && IsBlank(Find(txtSearchForUserSFUS.Text, locCurrSearchText)),
                UpdateContext({locStartLoadingTimer:true, locCurrSearchText: txtSearchForUserSFUS.Text});
            
                //Perform the user search
                If(
                    txtSearchForUserSFUS.Text <> "",
                    If(IsEmpty(MatchAll(txtSearchForUserSFUS.Text, "([\s\.\?\*\+\(\)\[\]\{\}\^\$\|\,])")),
                        ClearCollect(colFindAColleague_Results,
                            Filter(
                                Office365Users.SearchUserV2(
                                    {
                                        searchTerm: txtSearchForUserSFUS.Text
                                    }
                                ).value,
                                AccountEnabled,
                                (
                                    EndsWith(ThisRecord.Mail, "@ised-isde.gc.ca") || EndsWith(ThisRecord.Mail, "@cb-bc.gc.ca") || EndsWith(ThisRecord.Mail, "@ocsa-bcsc.gc.ca") || EndsWith(ThisRecord.Mail, "@cb-cda.gc.ca")
                                ),
                                Lower(ThisRecord.Mail) <> Lower(gblAppUserDetails.mail)
                            )
                        );
                        Reset(galFoundUsersSFUS),
                        Clear(colFindAColleague_Results);
                    )
                );
                //Stop the timer
                UpdateContext({locLoadingDuration: 2000})
            )
        PaddingBottom: =Self.PaddingTop
        PaddingLeft: =Self.PaddingTop
        PaddingRight: =Self.PaddingTop
        PaddingTop: |
            =Min(10 * Switch(Value(lblScreenWidthSizingSFUS.Text),  
                    ScreenSize.Small, 1,  
                    ScreenSize.Medium, 1.25,
                    ScreenSize.Large, 1.5,  
                    1.9),
                10 * Switch(cmpScreenFunctionsSFUS.ScreenSize,  
                    ScreenSize.Small, 1,  
                    ScreenSize.Medium, 1.25,
                    ScreenSize.Large, 1.5,  
                    1.9)
                )
        PressedBorderColor: =RGBA(0,0,0,0)
        PressedFill: =Self.HoverFill
        RadiusBottomRight: =Self.RadiusTopRight
        RadiusTopRight: |-
            =Min(25 * Switch(Value(lblScreenWidthSizingSFUS.Text),  
                    ScreenSize.Small, 1,  
                    ScreenSize.Medium, 1.5,
                    ScreenSize.Large, 1.75,  
                    2),
                25 * Switch(cmpScreenFunctionsSFUS.ScreenSize,  
                    ScreenSize.Small, 1,  
                    ScreenSize.Medium, 1.5,
                    ScreenSize.Large, 1.75,  
                    2)
            )
        TabIndex: =0
        Width: =Self.Height * 1.5
        X: =txtSearchForUserSFUS.X + txtSearchForUserSFUS.Width
        Y: =txtSearchForUserSFUS.Y
        ZIndex: =12

    imgClearSearch As image:
        AccessibleLabel: =LookUp(colTranslationTable, key = "searchforuser.clear" && language.Value = gblAppUserLang, text)
        BorderColor: =RGBA(0, 0, 0, 0)
        Fill: =LookUp(Colors, Color = "Grey", RGB)
        FocusedBorderColor: =LookUp(Colors, Color = "Focus Primary", RGB)
        FocusedBorderThickness: |-
            =Min(2.5 * Switch(Value(lblScreenWidthSizingSFUS.Text),
                        ScreenSize.Small, 1,
                        ScreenSize.Medium, 1.25,
                        ScreenSize.Large, 1.5,
                        1.75),
                2.5 * Switch(cmpScreenFunctionsSFUS.ScreenSize,
                        ScreenSize.Small, 1,
                        ScreenSize.Medium, 1.25,
                        ScreenSize.Large, 1.5,
                        1.75)
            )
        Height: |
            =Min(30 * Switch(Value(lblScreenWidthSizingSFUS.Text),  
                    ScreenSize.Small, 1,  
                    ScreenSize.Medium, 1.5,
                    ScreenSize.Large, 1.75,  
                    2),
                30 * Switch(cmpScreenFunctionsSFUS.ScreenSize,  
                    ScreenSize.Small, 1,  
                    ScreenSize.Medium, 1.5,
                    ScreenSize.Large, 1.75,  
                    2) 
            )
        HoverBorderColor: =Self.BorderColor
        HoverFill: =RGBA(0,0,0,0.65)
        Image: ='clear (white)'
        OnSelect: |-
            =Reset(txtSearchForUserSFUS); Clear(colFindAColleague_Results); UpdateContext({locCurrSearchText: ""});
        PaddingBottom: =Self.PaddingTop
        PaddingLeft: =Self.PaddingTop
        PaddingRight: =Self.PaddingTop
        PaddingTop: |
            =Min(7 * Switch(Value(lblScreenWidthSizingSFUS.Text),  
                    ScreenSize.Small, 1,  
                    ScreenSize.Medium, 1.25,
                    ScreenSize.Large, 1.5,  
                    1.9),
                7 * Switch(cmpScreenFunctionsSFUS.ScreenSize,  
                    ScreenSize.Small, 1,  
                    ScreenSize.Medium, 1.25,
                    ScreenSize.Large, 1.5,  
                    1.9)
                )
        PressedBorderColor: =Self.BorderColor
        PressedFill: =RGBA(0,0,0,0.7)
        RadiusBottomLeft: =Self.RadiusTopLeft
        RadiusBottomRight: =Self.RadiusTopLeft
        RadiusTopLeft: |-
            =Min(20 * Switch(Value(lblScreenWidthSizingSFUS.Text),  
                    ScreenSize.Small, 1,  
                    ScreenSize.Medium, 1.5,
                    ScreenSize.Large, 1.75,  
                    2),
                20 * Switch(cmpScreenFunctionsSFUS.ScreenSize,  
                    ScreenSize.Small, 1,  
                    ScreenSize.Medium, 1.5,
                    ScreenSize.Large, 1.75,  
                    2)
            )
        RadiusTopRight: =Self.RadiusTopLeft
        TabIndex: =0
        Visible: =!IsBlank(txtSearchForUserSFUS.Text)
        Width: =Self.Height
        X: =txtSearchForUserSFUS.X + txtSearchForUserSFUS.Width - (Self.Width * 1.5)
        Y: =txtSearchForUserSFUS.Y + txtSearchForUserSFUS.Height/2 - Self.Height/2
        ZIndex: =13

    lblSearchForAColleagueSectionSFUS As label:
        Height: =0
        Role: =TextRole.Heading2
        Size: =0
        Text: =LookUp(colTranslationTable, key = "searchforuser.searchsection" && language.Value = gblAppUserLang, text)
        Width: =
        X: =shpPageBackdropSFUS.X
        Y: =cmpHeaderSFUS.Y + cmpHeaderSFUS.Height
        ZIndex: =14

    grpRefineSearch As group:
        Height: =5
        Width: =5
        X: =17.5
        Y: =759.1666666666667
        ZIndex: =15

        lblRefineSearchSFUS As label:
            Align: =Align.Center
            AutoHeight: =true
            Color: =LookUp(Colors, Color = "Primary", RGB)
            Font: =Font.'Lato Black'
            Height: =70
            PaddingLeft: =10
            PaddingRight: =10
            Size: |-
                =Min(21 * Switch(Value(lblScreenWidthSizingSFUS.Text),  
                        ScreenSize.Small, 1,  
                        ScreenSize.Medium, 1.5,
                        ScreenSize.Large, 1.75,  
                        1.9),
                    21 * Switch(cmpScreenFunctionsSFUS.ScreenSize,  
                        ScreenSize.Small, 1,  
                        ScreenSize.Medium, 1.5,
                        ScreenSize.Large, 1.75,  
                        1.9) 
                )
            Text: |
                =If(CountRows(colFindAColleague_Results) = 0 && !IsBlank(txtSearchForUserSFUS.Text) && !IsBlank(Find(txtSearchForUserSFUS.Text, locCurrSearchText)),
                    LookUp(
                        colTranslationTable,
                        key = "searchforuser.nousersfound" && language.Value = gblAppUserLang,
                        text
                    ),
                    LookUp(
                        colTranslationTable,
                        key = "searchforuser.refinesearch" && language.Value = gblAppUserLang,
                        text
                    )
                )
            Visible: =CountRows(galFoundUsersSFUS.AllItems) < 1 && IsBlank(First(galFoundUsersSFUS.AllItems).Id)
            Width: =crdGalleryBackgroundSFUS.Width/1.25
            X: =shpPageBackdropSFUS.X + shpPageBackdropSFUS.Width/2 - Self.Width/2
            Y: |-
                =imgRefineSearchSFUS.Y + imgRefineSearchSFUS.Height + 
                Min(18 * Switch(Value(lblScreenWidthSizingSFUS.Text),  
                        ScreenSize.Small, 1,  
                        ScreenSize.Medium, 1.5,
                        ScreenSize.Large, 1.75,  
                        1.9),
                    18 * Switch(cmpScreenFunctionsSFUS.ScreenSize,  
                        ScreenSize.Small, 1,  
                        ScreenSize.Medium, 1.5,
                        ScreenSize.Large, 1.75,  
                        1.9) 
                )
            ZIndex: =7

        imgRefineSearchSFUS As image:
            Height: =Self.Width
            Image: |-
                =If(CountRows(colFindAColleague_Results) = 0 && !IsBlank(txtSearchForUserSFUS.Text) && !IsBlank(Find(txtSearchForUserSFUS.Text, locCurrSearchText)),
                    alert_circle,
                    search
                )
            PaddingBottom: =2
            PaddingLeft: =2
            PaddingRight: =2
            PaddingTop: =2
            Visible: =CountRows(galFoundUsersSFUS.AllItems) < 1 && IsBlank(First(galFoundUsersSFUS.AllItems).Id)
            Width: =Min(crdGalleryBackgroundSFUS.Width/2, crdGalleryBackgroundSFUS.Height/3)
            X: =shpPageBackdropSFUS.X + shpPageBackdropSFUS.Width/2 - Self.Width/2
            Y: |-
                =((crdGalleryBackgroundSFUS.Y) + (crdGalleryBackgroundSFUS.Y + crdGalleryBackgroundSFUS.Height)) / 2 - 
                (Self.Height + 
                Min(18 * Switch(Value(lblScreenWidthSizingSFUS.Text),  
                        ScreenSize.Small, 1,  
                        ScreenSize.Medium, 1.5,
                        ScreenSize.Large, 1.75,  
                        1.9),
                    18 * Switch(cmpScreenFunctionsSFUS.ScreenSize,  
                        ScreenSize.Small, 1,  
                        ScreenSize.Medium, 1.5,
                        ScreenSize.Large, 1.75,  
                        1.9) 
                ) +
                lblRefineSearchSFUS.Height)/2
            ZIndex: =8

    grpScreenSizingSFUS As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =16

        lblScreenWidthSizingSFUS As label:
            Height: =0
            Size: =21
            Text: =Parent.Size
            Visible: =false
            Width: =0
            X: =shpPageBackdropSFUS.X + shpPageBackdropSFUS.Width
            Y: =shpPageBackdropSFUS.Y + shpPageBackdropSFUS.Height
            ZIndex: =3

        cmpScreenFunctionsSFUS As cmp_ScreenFunctions:
            AppHeight: =App.Height
            AppHeightBreakPoints: =AppHeightBreakpoints
            X: =shpPageBackdropSFUS.X + shpPageBackdropSFUS.Width
            Y: =shpPageBackdropSFUS.Y + shpPageBackdropSFUS.Height
            ZIndex: =4

    timLoadingSFUS As timer:
        AutoPause: =false
        Duration: =locLoadingDuration
        Height: =125
        OnTimerEnd: |-
            =UpdateContext({locIsLoadingVisible: false, locStartLoadingTimer:false});
            UpdateContext({ locStartDoneTimer:true});
        OnTimerStart: |-
            =UpdateContext({locIsLoadingVisible: true});
        Reset: =true
        Start: =locStartLoadingTimer
        Visible: =false
        Width: =32
        X: =608
        Y: =1011
        ZIndex: =17

    timDoneLoadingSFUS As timer:
        Duration: =2000
        Height: =125
        OnTimerEnd: |-
            =UpdateContext({locIsDoneLoadingVisible:false, locStartDoneTimer:false});
        OnTimerStart: |-
            =UpdateContext({locIsDoneLoadingVisible: true});
        Reset: =true
        Start: =locStartDoneTimer
        Visible: =false
        Width: =32
        X: =608
        Y: =1011
        ZIndex: =18

    cmpLoadingAnimationSFUS As cmp_LoadingAnimation:
        Height: =cmpHeaderSFUS.Height
        IsTextVisible: =locIsLoadingVisible
        LoadingText: =LookUp(colTranslationTable, key = "loading.text" && language.Value = gblAppUserLang, text)
        PrimaryColor: =
        Visible: =true
        X: =570
        Y: =cmpHeaderSFUS.Y + cmpHeaderSFUS.Height/2 - Self.Height/2
        ZIndex: =19

    cmpDoneAnimationSFUS As cmp_LoadingDoneAnimation:
        DoneLoadingText: =LookUp(colTranslationTable, key = "loadingdone.text" && language.Value = gblAppUserLang, text)
        Height: =cmpHeaderSFUS.Height
        IsTextVisible: =locIsDoneLoadingVisible
        PrimaryColor: =
        Visible: =true
        X: =595
        Y: =cmpHeaderSFUS.Y + cmpHeaderSFUS.Height/2 - Self.Height/2
        ZIndex: =20

    cmpHeaderSFUS As cmp_PageHeading:
        BackText: =LookUp(colTranslationTable, key = "header.back" && language.Value = gblAppUserLang, text)
        FocusedColor: =LookUp(Colors, Color = "Focus Primary", RGB)
        FontSize: |-
            =Min(22 * Switch(Value(lblScreenWidthSizingSFUS.Text),  
                    ScreenSize.Small, 1,  
                    ScreenSize.Medium, 1.5,
                    ScreenSize.Large, 1.75,  
                    2),
                22 * Switch(cmpScreenFunctionsSFUS.ScreenSize,  
                    ScreenSize.Small, 1,  
                    ScreenSize.Medium, 1.5,
                    ScreenSize.Large, 1.75,  
                    2)
            )
        HeadingText: =LookUp(colTranslationTable, key = "header.searchforuser" && language.Value = gblAppUserLang, text)
        Height: |-
            =Min(78 * Switch(Value(lblScreenWidthSizingSFUS.Text),  
                    ScreenSize.Small, 1,  
                    ScreenSize.Medium, 1.25,
                    ScreenSize.Large, 1.5,  
                    1.75),
                78 * Switch(cmpScreenFunctionsSFUS.ScreenSize,  
                    ScreenSize.Small, 1,  
                    ScreenSize.Medium, 1.25,
                    ScreenSize.Large, 1.5,  
                    1.75)
            )
        PositionOffset: |-
            =//Recreates the card offset using non-dependent properties
            (Parent.Width/2 -
            (If(Parent.Size <> ScreenSize.ExtraLarge, App.Width-4, (App.DesignWidth*2)-4)
            - (10 * Switch(Parent.Size,  
                    ScreenSize.Small, 1,  
                    ScreenSize.Medium, 1.5,  
                    ScreenSize.Large, 1.75,
                    5))
            - (25 * Switch(Parent.Size,  
                    ScreenSize.Small, 1,  
                    ScreenSize.Medium, 1.5,  
                    ScreenSize.Large, 1.75,
                    5)))/2)
            - shpPageBackdropSFUS.X
        PrimaryColor: =LookUp(Colors, Color = "Primary", RGB)
        ScreenSize_Height: =cmpScreenFunctionsSFUS.ScreenSize
        ScreenSize_Width: =Value(lblScreenWidthSizingSFUS.Text)
        SecondaryColor: =LookUp(Colors, Color = "Background", RGB)
        Width: =If(Parent.Size <> ScreenSize.ExtraLarge, App.Width-4, (App.DesignWidth*2)-4)
        X: =(Parent.Width-Self.Width) /2
        Y: |-
            =If(
            Parent.Size=ScreenSize.Small,
            2,
            4
            )
        ZIndex: =21

    grpLoadingPageSFUS As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =31

        crdLoadingPageSFUS As button:
            BorderColor: =LookUp(Colors, Color = "Primary", RGB)
            BorderThickness: =0
            DisplayMode: =DisplayMode.View
            Fill: =RGBA(255, 255, 255, 1)
            Height: |-
                =shpPageBackdropTS.Height - Self.Y - 
                Min(40 * Switch(Value(lblScreenWidthSizingSFUS.Text),  
                        ScreenSize.Small, 1,  
                        ScreenSize.Medium, 1.5,
                        ScreenSize.Large, 1.75,  
                        2),
                    40 * Switch(cmpScreenFunctionsSFUS.ScreenSize,  
                        ScreenSize.Small, 1,  
                        ScreenSize.Medium, 1.5,
                        ScreenSize.Large, 1.75,  
                        2) 
                )
            HoverBorderColor: =
            HoverColor: =
            HoverFill: =
            RadiusBottomLeft: =Self.RadiusTopLeft
            RadiusBottomRight: =Self.RadiusTopLeft
            RadiusTopLeft: |-
                =Min(10 * Switch(Value(lblScreenWidthSizingSFUS.Text),  
                        ScreenSize.Small, 1,  
                        ScreenSize.Medium, 1.25,
                        ScreenSize.Large, 1.5,  
                        2),
                    10 * Switch(cmpScreenFunctionsSFUS.ScreenSize,  
                        ScreenSize.Small, 1,  
                        ScreenSize.Medium, 1.25,
                        ScreenSize.Large, 1.5,  
                        2)
                )
            RadiusTopRight: =Self.RadiusTopLeft
            Size: =0
            TabIndex: =-1
            Text: =
            Visible: =locIsLoadingVisible
            Width: =crdGalleryBackgroundSFUS.Width
            X: =shpPageBackdropSFUS.X + shpPageBackdropSFUS.Width/2 - Self.Width/2
            Y: |-
                =txtSearchForUserSFUS.Y + txtSearchForUserSFUS.Height + 
                Min(40 * Switch(Value(lblScreenWidthSizingSFUS.Text),  
                        ScreenSize.Small, 1,  
                        ScreenSize.Medium, 1.5,
                        ScreenSize.Large, 1.75,  
                        2),
                    40 * Switch(cmpScreenFunctionsSFUS.ScreenSize,  
                        ScreenSize.Small, 1,  
                        ScreenSize.Medium, 1.5,
                        ScreenSize.Large, 1.75,  
                        2) 
                )
            ZIndex: =15

        imgLoadingResultsSFUS As image:
            DisplayMode: =DisplayMode.View
            Height: =Self.Width
            Image: =loading_spinner
            Visible: =locIsLoadingVisible
            Width: =Min(crdLoadingPageSFUS.Width/2, crdLoadingPageSFUS.Height/3)
            X: =crdLoadingPageSFUS.X + crdLoadingPageSFUS.Width/2 - Self.Width/2
            Y: |
                =crdLoadingPageSFUS.Y + crdLoadingPageSFUS.Height/2 - Self.Height/2
            ZIndex: =16

